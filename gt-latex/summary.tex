\documentclass{article}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{environ}

\usepackage{mathtools}
\usepackage[
    top=    1.00in,
    bottom= 1.00in,
    left=   1.00in,
    right=  1.00in,
]{geometry}

\usepackage{hyperref}

% no indent
\setlength\parindent{0pt}

% Theorem environments
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{example}{Example}
\newtheorem{problem}{Problem}
\newtheorem{corollary}{Corollary}


\NewEnviron{answer}{%
  \par\noindent\vspace{10pt}%
  \textcolor{red}{\textbf{Answer}:}
  \par\noindent\textcolor{red}{\BODY}%
  \par\vspace{-0.5\baselineskip}\raggedleft\textcolor{red}{$\blacksquare$}%
  \par\vspace{10pt}
}


\author{Taiyun}
\title{MATH-3012-QHS \\ Lecture Notes}
\date{Professor Dr. Kalila Lehmann}

\begin{document}

\maketitle







\section*{Lesson M4.1: Introduction to Generating Functions}
\section*{Learning Goals}
\begin{itemize}
  \item Define and describe ordinary generating functions and their uses
  \item Use generating functions to solve problems at an appropriate level
\end{itemize}

\section*{Textbook References}
Grimaldi: 9.1\\
Keller and Trotter: 8.1-8.3\\
Levin: 5.1; 2.1 and 2.2 may also be a useful refresher on sequences.

\section*{Lesson}
In the last module, we learned that Rook polynomials are a convenient structure for storing a sequence of rook numbers in an indexed, organized, and concise way. That was so nice, we want to generalize it- because there was nothing special about rook numbers; we can do this with any sequence!

Suppose we care about the sequence

$$
\left(s_{n}\right)_{n \geq 0}=(0,1,0,0,2,0,0,0,3,0,0,0,0,4, \ldots)
$$

This is a nice pattern- and we notice both that:

\begin{itemize}
  \item The sequence can be described by its nonzero terms
  \item The nonzero terms are very sparse
\end{itemize}

This combination of observations means that by writing down or storing information about the whole sequence, we are being really inefficient!

To efficiently describe our sequence, we'd like to store only the nonzero terms, along with a record of which index they belong to- polynomials are a good way to do that.

We can again write the $n^{\text {th }}$ term of our sequence as the coefficient of $x^{n}$. In this general setting, the result is a power series (a fancy name for a potentially infinite polynomial) that encodes our sequence. In this case,

$$
\begin{aligned}
p(x) & =s_{0} x^{0}+s_{1} x+s_{2} x^{2}+s_{3} x^{3}+\cdots \\
& =0+1 \cdot x+0 x^{2}+0 x^{3}+2 x^{4}+0 x^{5}+0 x^{6}+0 x^{7}+3 x^{8}+\cdots \\
& =x+2 x^{4}+3 x^{8}+4 x^{13}+\cdots
\end{aligned}
$$

This power series, in many fewer terms, actually encodes our entire sequence without losing any information. A power series that is currently being understood to encode a particular sequence is called a generating function. To be precise:

\begin{definition}[Ordinary Generating Function]
An \textbf{ordinary generating function (OGF)} encodes the terms of a sequence $\left(s_{n}\right)_{n \geq 0}$ as the coefficients of $x^{n}$ for $n \geq 0$.

That is, the OGF of $\left(s_{n}\right)_{n \geq 0}$ is 
\[f(x)=\sum_{n=0}^{\infty} s_{n} x^{n}.\]

In this case, we say the function $f(x)$ \textbf{generates} the sequence $\left(s_{n}\right)_{n \geq 0}$.
\end{definition}

Why do we care about doing this? Well, rook polynomials did two things for us: allowed us to efficiently encode the rook numbers of chessboards, and also exploit the structure of polynomial/power series multiplication to find information about larger chessboards.

We have other sequences we care about, often associated with combinatorial objects- so again we'd like to know the most efficient way to store them (by allowing the removal of zero terms) and also set up a structure where we might be able to combine them somehow to learn about new things.

Let's begin by looking at an example where we can make our lives a lot easier by replacing some of the other tools we have with a couple of generating functions.

\begin{example}
How many non-negative integer solutions are there to $a+b+c=10$, where
\begin{align}
2 &\leq a \leq 4 \\
3 &\leq b \leq 5 \\
2 &\leq c \leq 5
\end{align}
\end{example}





\textbf{Note}:
\begin{enumerate}
  \item \textbf{Generating functions}: model each variable
  \item \textbf{Polynomial Degree} $n$: an event (independent)
  \item \textbf{Addition}: sum rule of counting
  \item \textbf{Multiplication}: product rule of counting
  \item \textbf{Coefficient} of $x^{n}$: total number of solutions to the event
\end{enumerate}



We already know a couple of ways to solve this problem:

\textbf{Strategy 1:} List solutions explicitly (there are 8): this is reasonably possible here, but isn't usually a viable approach so we don't really want to make it our standard plan.

\textbf{Strategy 2:} Substitute to move each of the lower bounds up to 0, and use PIE to address the upper bounds. We know how to do this and it always works, but it seems like overkill for such a small problem!

\textbf{Strategy 3:} Represent possible values of each variable with a polynomial:

For each variable, the coefficient of $x^{i}$ in the corresponding polynomial is the number of different ways the variable could attain the value $i$. Thus a term $x^{i}$ has a nonzero coefficient (and appears in the polynomial) exactly when $i$ is a possible value of the variable.

In this problem, there is only one way a particular variable could have a specific value, so all coefficients are 1.

To use this strategy, then, we begin by writing the following polynomials:

\begin{align}
2 \leq a \leq 4 \quad &\text{is represented by} \quad f_{a}(x)=x^{2}+x^{3}+x^{4} \\
3 \leq b \leq 5 \quad &\text{is represented by} \quad f_{b}(x)=x^{3}+x^{4}+x^{5} \\
2 \leq c \leq 5 \quad &\text{is represented by} \quad f_{c}(x)=x^{2}+x^{3}+x^{4}+x^{5}
\end{align}

We can then multiply the polynomials for each variable to get a generating function that describes the whole situation, or all possible ways to combine all possible values of each variable (whether or not we get the desired sum).

\begin{align}
f(x) &= f_{a}(x) f_{b}(x) f_{c}(x) \\
&= \left(x^{2}+x^{3}+x^{4}\right)\left(x^{3}+x^{4}+x^{5}\right)\left(x^{2}+x^{3}+x^{4}+x^{5}\right) \\
&= x^{7}+3 x^{8}+6 x^{9}+8 x^{10}+8 x^{11}+6 x^{12}+3 x^{13}+x^{14}
\end{align}

In this polynomial, the coefficient of $x^{i}$ is the number of different ways we can get a sum of $i$ using the allowed values of each of our variables.

Thus the number of solutions to our equation (where $a+b+c=10$) is the coefficient of $x^{10}$, which is 8, as expected.

Notice what just happened here---we solved infinitely many problems simultaneously! We only needed the coefficient of $x^{10}$ to solve this problem, but we have the coefficient of every power of $x$ (most of them are just 0).

So not only have we solved our problem, we have actually done all the work to solve any problem where $a+b+c=n$ under these same bounds.

A new strategy, then, is to solve problems like this by representing possibilities for each part with a generating function, then multiplying to get the big picture. Not only is this process pretty simple and efficient, it nicely allows us to account for more interesting conditions placed on each part of the problem.

\begin{example}
Find an OGF that gives the number of non-negative integer solutions to the equation
\[q+r+s+t=n\]
where
\begin{align}
q &\leq 4 \quad \text{and} \quad s \text{ is odd} \\
r &> 7 \quad \text{and} \quad t \text{ is even}
\end{align}
\end{example}

Let's start with a polynomial for each variable: $f_{q}(x)=1+x+x^{2}+x^{3}+x^{4}$ since the possible values of $q$ are $0,1,2,3$, and 4.

Similarly, $r$ may take on any value of at least 8, so $f_{r}(x)=x^{8}+x^{9}+x^{10}+\cdots=\sum_{i=8}^{\infty} x^{i}$.

We approach $s$ and $t$ in the same way, with some care given to the way we write our summations (which are often the best way to carefully and concisely express the terms of our power series):

\begin{align}
f_{s}(x) &= x+x^{3}+x^{5}+x^{7}+\cdots=\sum_{i=0}^{\infty} x^{2 i+1} \\
f_{t}(x) &= 1+x^{2}+x^{4}+x^{6}+\cdots=\sum_{i=0}^{\infty} x^{2 i}
\end{align}

So overall, the number of solutions to our equation is the coefficient of $x^{n}$ in the generating function
\[f(x)=f_{q}(x) f_{r}(x) f_{s}(x) f_{t}(x)=\left(1+x+x^{2}+x^{3}+x^{4}\right)\left(\sum_{i=8}^{\infty} x^{i}\right)\left(\sum_{i=0}^{\infty} x^{2 i+1}\right)\left(\sum_{i=0}^{\infty} x^{2 i}\right).\]

Now you try!

\begin{problem}
A hungry college student wants to order a lot of chicken nuggets. The restaurant sells nuggets in boxes of 2, 3, or 7. In how many different ways can they order $n$ nuggets?

\textbf{Hint:} There is only one way to order a box of a particular size. The size of the boxes determines how many nuggets the ones from each kind of box can contribute to your total!
\end{problem}

We want to find the number of non-negative integer solutions to the equation $2a+3b+7c=n$.

We start by writing down functions that represent the possible contributions of each term to the total:

$2a$ can contribute $0,2,4,6$, etc., so is represented by
\[f_{a}(x)=1+x^{2}+x^{4}+\cdots=\sum_{i=0}^{\infty} x^{2 i}.\]

Similarly, $f_{b}(x)=\sum_{i=0}^{\infty} x^{3 i}$ and $f_{c}(x)=\sum_{i=0}^{\infty} x^{7 i}$.

So the number of possible solutions is the coefficient of $x^{n}$ in
\[f(x)=f_{a}(x) f_{b}(x) f_{c}(x)=\left(\sum_{i=0}^{\infty} x^{2 i}\right)\left(\sum_{i=0}^{\infty} x^{3 i}\right)\left(\sum_{i=0}^{\infty} x^{7 i}\right).\]












\newpage




\section*{Quiz Questions}

\begin{enumerate}
  \item Suppose $f(x)=\sum_{n=0}^{\infty} x^{4 n}=1+x^{4}+x^{8}+\cdots$ 
  is the ordinary generating function for the 
  sequence $\left(a_n\right)_{n \geq 0}$. 
  Find the following terms of the sequence:
  $$
  a_0=1
  $$
  $$
  a_8=1
  $$
  $$
  a_{11}=0
  $$
  \item Which of the following is the ordinary 
  generating function for the sequence 
  $(0,1,2,3,4,5, \ldots)$ ?
\begin{enumerate}
  \item $\sum_{n=0}^{\infty} n x^n = {0} x^{0}+{1} x^{1}+{2} x^{2}+\cdots \to (0,1,2,3,4,5, \ldots)$
  \item $\sum_{n=0}^{\infty} n x = {0} x+{1} x+{2} x+\cdots = ({0} +{1}+{2} +\cdots) x \to  (0,0+1+2+\cdots,0,0,0,0, \ldots)$
  \item $\sum_{n=0}^{\infty} x^n = x^{0} + x^{1} + x^{2} + \cdot \to (1,1,1,1,1,1, \ldots)$
\end{enumerate}
  \item Suppose we want to find the number of integer solutions to the equation $a+b+c=18$, where $3 \leq a \leq 7$. Which of the following generating functions correctly represents the possible contributions of $a$ to the sum?
\begin{enumerate}
  \item $3 x+4 x+5 x+6 x+7 x$
  \item $3 x^3+4 x^4+5 x^5+6 x^6+7 x^7$
  \item $1+x^3+x^4+x^5+x^6+x^7$
  \item $x^3+x^4+x^5+x^6+x^7$
\end{enumerate}


\item In the case of lattice path, say you have square lattice of size $2$.
Here are the states.
\begin{enumerate}
  \item You start from the left bottom corner and want to reach the top right corner. (degree 0)
  \item You start from the left bottom corner and want to reach the right bottom corner. (degree 1)
  \item You start from the left bottom corner and want to reach the top left corner. (degree 2)
\end{enumerate}
What is the correct generating function for this lattice path problem?
\[
  f(x) = 2x^{0} + 1x^{1} + 1x^{2}
\]


\end{enumerate}












\newpage



\section*{Lesson M4.2: Closed Forms}
\section*{Learning Goals}
\begin{itemize}
  \item Convert between power series and closed form expressions
  \item Apply manipulation techniques to generating functions
  \item Use substitution and differentiation to transform sequences
\end{itemize}

\section*{Textbook References}
Grimaldi: Relevant parts of section 9.2\\
Keller and Trotter: 8.1-8.3\\
Levin: 5.1; 2.1 and 2.2 may also be a helpful refresher on sequences.


\textbf{Note}: 
\underbar{Ordinary generating functions} are just \underbar{power series} in Calculus.
By convergence and divergence tests, you could find the convergent form of a \underbar{power series} (\underbar{taylor series}).
$$
f_a(x)=\underset{\text{closed form}}{\sin{x}} = \sum_{n=0}^{\infty} (-1)^n \frac{x^{2n+1}}{(2n+1)!} = \underset{\text{Ordinary generating function}}{x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots}
$$


Here, $\sin{x}$ is the convergent form (\textbf{closed form}) of the taylor series (\textbf{Ordinary generating functions}).



For example, you are given sine and cosine closed forms. And you have to find
product of sine and cosine events where the degree is $10$.
$$
f_b(x)=\cos{x} = \sum_{n=0}^{\infty} (-1)^n \frac{x^{2n}}{(2n)!} = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots
$$

Which calculation feels easier?
$$
\sin{x} \cdot \cos{x} = \frac{1}{2} \sin{2x} = \frac{1}{2} \sum_{n=0}^{\infty} (-1)^n \frac{(2x)^{2n+1}}{(2n+1)!} = \frac{1}{2} \left(2x - \frac{(2x)^3}{3!} + \frac{(2x)^5}{5!} - \frac{(2x)^7}{7!} + \cdots\right)
$$
or
$$
\sum_{n=0}^{\infty} (-1)^n \frac{x^{2n+1}}{(2n+1)!} \cdot \sum_{n=0}^{\infty} (-1)^n \frac{x^{2n}}{(2n)!}
$$







% latex under comment




\section*{Lesson}
In our first lesson on generating functions, we learned that we can use a power series $\sum_{i=0}^{\infty} a_{i} x^{i}$ as a convenient indexed container for storing a sequence $\left(a_{i}\right)_{i \geq 0}$. Today we want to remember a fun fact from Calculus II: some power series converge nicely to a closed-form function, and these are very often nicer to work with.

Note: Since we are using power series strictly as a storage facility for the sequences we care about (and will not ever evaluate them at specific $x$ values), we do not need to worry about where they converge- the fact that they do anywhere is good enough for us.

\section*{Basic Functions}
Most of the generating functions we'll deal with this semester can be obtained from three basic "building block" functions---we'll look at those first, then move on to the various ways we can manipulate them to get other functions.

\textbf{Function 1:} We already know from our earlier studies that Binomial Coefficients work really nicely as coefficients (hence the name)---and we even have an expression that fits the format we are looking for:
\[(1+x)^{n}=\sum_{i=0}^{\infty}\binom{n}{i} x^{i}.\]

We may be used to seeing the summation on the right side terminate at $n$, but since all larger index terms are equal to 0, we can extend the sum with no consequences. We recognize this summation as one of the form we used to define a generating function, and therefore determine that the closed form function $(1+x)^{n}$ generates the sequence $\left(\binom{n}{i}\right)_{i \geq 0}=\left(\binom{n}{0},\binom{n}{1}, \ldots,\binom{n}{n}, 0,0, \ldots\right)$.

\textbf{Function 2:} We learned in Calculus about the convergence of geometric series: in particular, we know that
\[\frac{1}{1-x}=\sum_{i=0}^{\infty} x^{i}.\]

That is, $f(x)=\frac{1}{1-x}$ is a closed form function whose power series representation has a coefficient of 1 for every power of $x$---so it generates the sequence $(1,1,1,1,1,1, \ldots)$.

\textbf{Function 3:} Similarly, we know that $e^{x}=\sum_{i=0}^{\infty} \frac{x^{i}}{i!}=\sum_{i=0}^{\infty} \frac{1}{i!} x^{i}$, so $e^{x}$ is the closed form expression for the power series whose coefficients are $\frac{1}{i!}$---or in other words, $e^{x}$ generates the sequence $\left(\frac{1}{i!}\right)_{i \geq 0}$.

Before we move on, here is a chart to summarize these generating functions: you will need to know these correspondences.

\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{Function} & \textbf{Generates} \\
\hline
$(1+x)^{n} = \sum_{i=0}^{\infty}\binom{n}{i} x^{i}$ & $\left(\binom{n}{i}\right)_{i \geq 0}$ \\
\hline
$\frac{1}{1-x} = \sum_{i=0}^{\infty} x^{i}$ & $(1,1,1,1,1, \ldots)$ \\
\hline
$e^{x} = \sum_{i=0}^{\infty} \frac{x^{i}}{i!}$ & $\left(\frac{1}{i!}\right)_{i \geq 0}$ \\
\hline
\end{tabular}
\end{center}

\section*{Manipulation Techniques}
Almost all of the techniques we will discuss are consequences of algebraic manipulations that can be done to power series. We may not need to be proficient in doing all of the detailed derivations carefully, but this perspective can help us to understand where the rules come from.

\begin{enumerate}
  \item \textbf{Multiply by a Constant}
\end{enumerate}

To multiply every term of a sequence by a constant $c$, we can use the fact that factoring still works nicely in power series.

That is, if we know that $f(x)$ generates the sequence $\left(a_{i}\right)_{i \geq 0}$ and we'd like a generating function for $\left(c \cdot a_{i}\right)_{i \geq 0}$, we just multiply:
\[\sum_{i=0}^{\infty} c a_{i} x^{i}=c \sum_{i=0}^{\infty} a_{i} x^{i}=c \cdot f(x).\]

\begin{problem}
Find the ordinary generating function for the sequence $(2,2,2,2, \ldots)$.
\end{problem}

$\sum_{i=0}^{\infty} 2 x^{i}=2 \sum_{i=0}^{\infty} x^{i}=\frac{2}{1-x}=2 \cdot \frac{1}{1-x}$.

So we can derive the generating function $\frac{2}{1-x}$ from the definition, or can recognize our sequence as $2(1,1,1,1, \ldots)$ and multiply the function we already know by 2 to get the same answer.

\begin{enumerate}
\setcounter{enumi}{1}
\item \textbf{Shift by an index}
\end{enumerate}

To keep the same list of numbers, but shift them by one index to the right, we can multiply through by $x$ to shift the alignment of coefficients with powers of $x$.

That is, if $\left(a_{i}\right)_{i \geq 0}=\left(a_{0}, a_{1}, a_{2}, \ldots\right)$ is the sequence generated by $f(x)=\sum_{i=0}^{\infty} a_{i} x^{i}$, then the function $x f(x)=x \sum_{i=0}^{\infty} a_{i} x^{i}=\sum_{i=0}^{\infty} a_{i} x^{i+1}=a_{0} x+a_{1} x^{2}+a_{2} x^{3}+\cdots$ generates the sequence $\left(0, a_{0}, a_{1}, a_{2}, \ldots\right)$.

\begin{problem}
Find the function that generates the sequence $\left(0,0,1,1, \frac{1}{2!}, \frac{1}{3!}, \ldots\right)$.
\end{problem}

We recognize that this sequence has denominators with factorials (so we might want to start with $e^{x}$), but we have shifted to get two 0s at the beginning. The sequence we want can be generated by the function $\sum_{i=0}^{\infty} \frac{x^{i+2}}{i!}=x^{2} e^{x}$.

\begin{enumerate}
\setcounter{enumi}{2}
\item \textbf{Multiply by the index}
\end{enumerate}

Suppose we know as a starting place that $f(x)=\sum_{i=0}^{\infty} a_{i} x^{i}$ generates $\left(a_{i}\right)_{i \geq 0}$, and we want to find the OGF for $\left(i a_{i}\right)_{i \geq 0}$.

The trick to this manipulation is to remember that differentiation has the effect of multiplying $x^{i}$ by $i$: we proceed then by differentiating both sides of the equality we already have.

\begin{align}
f(x) &= \sum_{i=0}^{\infty} a_{i} x^{i} \\
f^{\prime}(x) &= \sum_{i=0}^{\infty} i a_{i} x^{i-1}
\end{align}

This gives us the coefficients $i a_{i}$ that we wanted, but they don't line up with the correct index anymore (i.e., we want $i a_{i}$ in index $i$ of our sequence, but right now it's in spot $i-1$). We can fix this though---all we have to do is multiply by $x$ to realign. Thus $x f^{\prime}(x)=\sum_{i=0}^{\infty} i a_{i} x^{i}$ is the generating function we wanted.

\begin{problem}
Find the sequence generated by the OGF $\frac{2 x}{(1-x)^{2}}$.

\textbf{Hint:} What is the derivative of $\frac{1}{1-x}$?
\end{problem}

We know $\frac{1}{1-x}=\sum_{i=0}^{\infty} x^{i}$, and differentiating both sides gives us
\[\frac{1}{(1-x)^{2}}=\sum_{i=0}^{\infty} i x^{i-1}.\]

This is almost the function we have, but we need to multiply by $2 x$:
\[\frac{2 x}{(1-x)^{2}}=\sum_{i=0}^{\infty} 2 i x^{i}.\]

Extracting the coefficients, we now see that the sequence generated is $(2 i)_{i \geq 0}=(0,2,4,6,8, \ldots)$.

\begin{enumerate}
\setcounter{enumi}{3}
\item \textbf{Substitution}
\end{enumerate}

As with any other algebraic expression, we can replace $x$ with any other variable quantity in any generating function. Most basically, this has the effect of scaling coefficients or exponents.

For example:
\begin{enumerate}[label=(\alph*)]
\item $\frac{1}{1+4 x}=\sum_{i=0}^{\infty}(-4 x)^{i}=\sum_{i=0}^{\infty}(-4)^{i} x^{i}$, which generates the sequence $\left(1,-4,4^{2},-4^{3}, \ldots\right)$.
\item $e^{x^{2}}=\sum_{i=0}^{\infty} \frac{\left(x^{2}\right)^{i}}{i!}=1+\frac{x^{2}}{1!}+\frac{x^{4}}{2!}+\frac{x^{6}}{3!}+\cdots$, which generates the sequence $\left(1,0, \frac{1}{1!}, 0, \frac{1}{2!}, 0, \frac{1}{3!}, 0, \ldots\right)$.
\end{enumerate}

\begin{problem}
Find the sequence generated by the OGF $\frac{1}{1-x^{2}}$.
\end{problem}

We recognize this function as our standard geometric series, with $x^{2}$ substituted for $x$. Thus we know $\frac{1}{1-x^{2}}=\sum_{i=0}^{\infty}\left(x^{2}\right)^{i}=\sum_{i=0}^{\infty} x^{2 i}=1+x^{2}+x^{4}+x^{6}+x^{8}+\cdots$.

Reading off the coefficients, then, we see that the sequence generated is $(1,0,1,0,1,0, \ldots)$.

Don't worry if this feels like a lot right now---using all of these tools takes lots of practice!











\newpage
\section*{Quiz Questions}

\begin{enumerate}
  \item Which of the following is the Ordinary 
  Generating function for the sequence $(1,-1,1,-1,1,-1, \ldots)$ ?

  \begin{align*}
  f(x) &= 1 - x + x^2 - x^3 + x^4 - x^5 + \cdots \\
  &= 1 + (- x) + (- x)^2 + (- x)^3 + (-x)^4 + (- x)^5 + \cdots \\
  &= \sum_{n=0}^{\infty} (-x)^n \\
  &= \frac{1}{1 - (-x)} = \frac{1}{1 + x} \text{ where $x \in (-1,1)$}
  \end{align*}
  \begin{enumerate}
    \item $\frac{-1}{1-x}$
    \item $\frac{-1}{1+x}$
    \item $\frac{1}{1-x}$
    \item $\frac{1}{1+x}$
  \end{enumerate}

  \item Fill in the blanks: the sequence $\left(5^{n+1}\right)_{n \geq 0}$ 
  is generated by the function $\frac{a}{1-b}$, where
  $$
  a=\square
  $$
  $$
  b=\square
  $$

  Since $\left(5^{n+1}\right)_{n \geq 0} = \left(5 \cdot 5^n\right)_{n \geq 0} = 5(1,5,5^2,5^3, \ldots)$,
  we can multiply the function $\frac{1}{1-5x}$ by $5$.
  Thus, the function that generates the sequence $\left(5^{n+1}\right)_{n \geq 0}$ is $\frac{5}{1-5x}$.
  So, \underbar{$a=5$} and \underbar{$b=5x$}.



  \item Find the sequence generated by the OGF $4 x e^{5 x}$.\\
  \textbf{Hint}: Recall that $e^{x}=\sum_{n=0}^{\infty} \frac{x^{n}}{n!}$.
  \begin{align*}
    4 x e^{5 x} &= 4 x \sum_{n=0}^{\infty} \frac{(5 x)^{n}}{n!} \\
    &= 4 \sum_{n=0}^{\infty} \frac{5^{n}}{n!} x^{n+1} = \sum_{n=1}^{\infty} 4 \cdot \frac{5^{n-1}}{(n-1)!} x^{n}\\
    &= \left(4 \cdot \frac{5^{n-1}}{(n-1)!}\right)_{n > 0} \text{ where $x \in \mathbb{R}$}
  \end{align*}

  \begin{enumerate}
    \item $\left(\frac{5^{n-1}}{(n-1)!}\right)_{n>0}$
    \item $\left(4 \cdot \frac{5^n}{(n)!}\right)_{n > 0}$
    \item $\left(4 \cdot \frac{5^{n+1}}{(n+1)!}\right)_{n > 0}$
    \item $\left(4 \cdot \frac{5^{n-1}}{(n-1)!}\right)_{n > 0}$
  \end{enumerate}



\end{enumerate}











\newpage



\section*{Lesson M4.3: Combining Generating Functions}
\section*{Learning Goals}
\begin{itemize}
  \item Use addition to form a generating function for the sum of two sequences
  \item Use multiplication to form a generating function for the convolution of two sequences
  \item Consistently use correct vocabulary and notation, with sufficient work, to discuss and work with generating functions
\end{itemize}

\section*{Textbook References}
Grimaldi: Relevant parts of section 9.2\\
Keller and Trotter: 8.1\\
Levin: 5.1

\section*{Lesson}
So far we have learned the basic building blocks of generating functions, and several ways of manipulating those generating functions to give us other similar ones. The last collection of tools we'll learn today allow us to create even more interesting generating functions by combining our building blocks, rather than just changing them.

We begin by recalling that the two nicest ways of combining any pair of functions are addition and multiplication (composition combined with power series is not something we want to try right now). In this lesson we investigate what the addition and multiplication of generating functions does to the sequences they generate.

\section*{Addition}
Addition of generating functions has the rather predictable effect of adding together the sequences they generate. This should make intuitive sense, as we can define the addition of two sequences by adding the terms in each index.

More carefully, if $f_{a}(x)$ generates $\left(a_{i}\right)_{i \geq 0}$ and $f_{b}(x)$ generates $\left(b_{i}\right)_{i \geq 0}$, then by summation rules we immediately have
\[\sum_{i=0}^{\infty} a_{i} x^{i}+\sum_{i=0}^{\infty} b_{i} x^{i}=\sum_{i=0}^{\infty}\left(a_{i}+b_{i}\right) x^{i}.\]

In other words, the function $f(x)=f_{a}(x)+f_{b}(x)$ generates the sequence $\left(a_{i}+b_{i}\right)_{i \geq 0}$.

\begin{example}
Suppose
\begin{align}
\left(a_{n}\right)_{n \geq 0} &= \left(1,3,3^{2}, 3^{3}, 3^{4}, \ldots\right) \\
\left(b_{n}\right)_{n \geq 0} &= (1,3,3,1,0,0, \ldots) \\
\left(c_{n}\right)_{n \geq 0} &= \left(2,2, \frac{2}{2!}, \frac{2}{3!}, \frac{2}{4!}, \ldots\right)
\end{align}

Then the corresponding generating functions are, respectively, $f_{a}(x)=\frac{1}{1-3 x}$, $f_{b}(x)=(1+x)^{3}$, and $f_{c}(x)=2 e^{x}$.

\begin{enumerate}[label=(\alph*)]
\item We see that the function $f_{a}(x)+f_{b}(x)=\frac{1}{1-3 x}+(1+x)^{3}$ generates the sequence $\left(1+1,3+3,3^{2}+3,3^{3}+1,3^{4}, 3^{5}, \ldots\right)$.

Note that this sequence looks like the sequence of increasing powers of 3, except for the first few terms---adding any polynomial to a generating function is a really nice way to change just a couple terms of a sequence that otherwise follows a more predictable pattern.

\item Similarly, the sequence $\left(\frac{2}{i!}+3^{i}\right)_{i \geq 0}$ is generated by $\frac{1}{1-3 x}+2 e^{x}=f_{a}(x)+f_{c}(x)$.
\end{enumerate}
\end{example}

\begin{problem}
Find the sequence generated by $2 e^{x}-(1+x)^{3}$.
\end{problem}

We recognize this function as $f_{c}(x)-f_{b}(x)$ and we know subtraction works the same way as addition---so we just need to subtract the corresponding terms in the sequences generated by each of the terms in our function.

That is, the sequence we want is $\left(\frac{2}{i!}-\binom{3}{i}\right)_{i \geq 0}=\left(2-1,2-3, \frac{2}{2!}-3, \frac{2}{3!}-1, \frac{2}{4!}, \ldots\right)$.

\section*{Multiplication}
Like addition, multiplication of closed form generating functions is relatively straightforward. The more interesting aspect of this process, though, is what happens with the corresponding power series expansions (and thus the sequences these functions generate). Multiplication of power series and sequences is not quite so straightforward.

One could, of course, try defining the product of two sequences by just multiplying corresponding terms---and we wouldn't run into anything weird right away. The reason we don't do this, though, is that it would completely break the way our generating functions work---and that's something we want to avoid.

For example, we know $(1+x)^{2}$ generates $(1,2,1,0,0, \ldots)$ and $(1+x)^{3}$ generates $(1,3,3,1,0,0, \ldots)$---so multiplying these series together term by term would give us $(1,2 \cdot 3,1 \cdot 3,0 \cdot 1,0,0, \ldots)=(1,6,3,0,0 \ldots)$.

But we also know that
\[(1+x)^{2}(1+x)^{3}=(1+x)^{5}=1+5 x+10 x^{2}+10 x^{3}+5 x^{4}+x^{5},\]
so by our original definition, this generating function has to generate the sequence $(1,5,10,10,5,1,0,0,0, \ldots)$. What we see here, then, is that multiplying term-by-term doesn't work.

The answer to this discrepancy is that we need a different definition of what it means to "multiply" two sequences together (and consequently, power series). The fact that we have power series to think about is actually helpful though---a power series is really just a pretentiously named infinite polynomial, and we know how to multiply polynomials together. So if we generalize that process, we see that all we need to do to multiply two series together is multiply every term in each series by every term in the other series, and add the results.

We do want to be careful about the order in which we multiply our terms, though: we'll get the same answer no matter what we do, but if we want to multiply together $\sum_{i=0}^{\infty} a_{i}$ and $\sum_{i=0}^{\infty} b_{i}$, if we start with $a_{0} b_{0}+a_{0} b_{1} x+a_{0} b_{2} x^{2}+a_{0} b_{3} x^{3}+\cdots$, we'll never get to what happens with the further terms of our first series, and won't be able to calculate what happens beyond scaling our second series by $a_{0}$.

Instead, then, we think about all the possible terms of our product, and we sort by what power of $x$ will be produced---this allows us to look at the whole picture for a finite number of terms. That is, we can write
\[\sum_{i=0}^{\infty} a_{i} x^{i} \sum_{i=0}^{\infty} b_{i} x^{i}=\left(a_{0} b_{0}\right)+\left(a_{0} b_{1}+a_{1} b_{0}\right) x+\left(a_{0} b_{2}+a_{1} b_{1}+a_{2} b_{0}\right) x^{2}+\cdots\]

Since the resulting sequence doesn't behave quite the way we usually imagine products working, we use a different word for it: combining two sequences in the way that corresponds to power series multiplication is called \textbf{convoluting}.

\begin{definition}[Convolution]
The sequence $\left(c_{i}\right)_{i \geq 0}$ generated by the product $f_{a}(x) f_{b}(x)$ is called the \textbf{convolution} of the sequences $\left(a_{i}\right)_{i \geq 0}$ and $\left(b_{i}\right)_{i \geq 0}$, i.e.,
\[f_{a}(x) f_{b}(x)=\sum_{i=0}^{\infty} a_{i} x^{i} \sum_{i=0}^{\infty} b_{i} x^{i}=\sum_{i=0}^{\infty} c_{i} x^{i}\]
where $c_{i}=\sum_{j=0}^{i} a_{j} b_{i-j}$.
\end{definition}

In practice, finding the convolution of two functions by looking at this formula is not what we want to do---we really want to exploit the fact that we know the generating functions for each separate sequence whenever we can. Not only does this save us a lot of tedious calculations, it gives us a much better chance of being able to write down the general pattern of the resulting sequence rather than just the first few terms---and this is always our goal.

\begin{example}
Find the convolution of the sequences $\left(a_{i}\right)_{i \geq 0}=(1,1,1,1, \ldots)$ and $\left(b_{i}\right)_{i \geq 0}=\left((-1)^{i}\right)_{i \geq 0}=(1,-1,1,-1, \ldots)$.
\end{example}

\textbf{Solution 1:} If we'd like, we could try the method we were just advised against. Using the definition above, we know the convolution $\left(c_{i}\right)_{i \geq 0}$ is generated by $\sum_{i=0}^{\infty} c_{i} x^{i}$, where
\[c_{i}=\sum_{n=0}^{i} a_{n} b_{i-n}=\sum_{n=0}^{i} a_{i-n} b_{n}=\sum_{n=0}^{i} 1^{i-n}(-1)^{n}=\sum_{n=0}^{i}(-1)^{n}.\]

Now we happen to be able to reason through what happens if we take a sum of a particular length of positive and negative 1s: the result is 1 if $i$ is even, and 0 if $i$ is odd. That is, the convolution we want is $(1,0,1,0,1,0, \ldots)=\left(\frac{1+(-1)^{i}}{2}\right)_{i \geq 0}$.

\textbf{Note:} This second fancy way of writing an alternating sequence as a fraction using an alternating sum in the numerator is really nothing more than a fancy trick---you might find it convenient, but you will not be tested on your ability to do this. You just need to be sure you fully describe the pattern of a sequence in a way that shows you understand what's going on beyond the first few terms.

\textbf{Solution 2:} Our preferred method of solution here is to remember that we actually know the generating functions for each of these sequences: $f_{a}(x)=\frac{1}{1-x}$, and $f_{b}(x)=\frac{1}{1+x}$.

The convolution of these two sequences, then, is generated by the product of their generating functions: $f(x)=f_{a}(x) f_{b}(x)=\frac{1}{1-x} \cdot \frac{1}{1+x}=\frac{1}{1-x^{2}}=\sum_{i=0}^{\infty} x^{2 i}$.

We get this last step from what we know about geometric sequences, and it allows us to read off the convolution as $(1,0,1,0, \ldots)$, or $c_{i}$ equal to 1 when $i$ is even and 0 when $i$ is odd, as expected---but without the tricks in the middle.

The last technique we need to think about is how to transform a convolution into something nicer to handle. Suppose we want to find the convolution of two sequences, and we know their generating functions in closed form, then all we need to do is multiply those functions together and figure out what sequence that OGF generates. This is great if the product we have happens to be exceptionally nice, but that's not usually what happens!

So instead we think: wouldn't it be great if we were adding instead of multiplying? That's so much easier. But the good news is that we know how to transform multiplication of fractions into addition---we just need a partial fraction decomposition.

\textbf{Note:} We won't go over the basics of this process in detail, since you know it from Calculus, and it's essentially the process of finding a common denominator, but run in reverse. If you want a refresher, check out Paul's Online Notes at \href{https://tutorial.math.lamar.edu/classes/calcii/partialfractions.aspx}{https://tutorial.math.lamar.edu/classes/calcii/partialfractions.aspx}---this is a calculus-based treatment, but it's a decent review nevertheless.

\begin{example}
Find the sequence generated by $f(x)=\frac{1}{(x-3)(x+2)}$.

First, let's use partial fractions to turn this product into a sum. We set up our equation:
\[\frac{1}{(x-3)(x+2)}=\frac{A}{x-3}+\frac{B}{x+2}.\]

Now we know these quantities are equal, so if we find a common denominator on the right side of the equation, we end up with
\[\frac{1}{(x-3)(x+2)}=\frac{A(x+2)}{(x-3)(x+2)}+\frac{B(x-3)}{(x-3)(x+2)}.\]

We can multiply both sides by the denominator to make things simpler:
\[A x+2 A+B x-3 B=1.\]

Now we just need to remember what makes two polynomials equal: the coefficients of each power of our variable need to be equal. Comparing these, we get $A+B=0$ (from the coefficients of $x$), and $2 A-3 B=1$ from the constant term.

The first equation tells us $A=-B$, and substituting into the second we find that $A=1/5$ and subsequently $B=-1/5$. It follows that $f(x)=\frac{1}{5(x-3)}-\frac{1}{5(x+2)}$.

Now we have transformed our problem into two smaller ones---we just need to sort out these geometric sequences. Be careful here though---we can only read off the generated sequence if a function is in the form $\frac{A}{1-B}$---and these aren't, so we need to do a bit of creative rewriting. This isn't too bad though---really all we need to do is remember (1) we can change the order of a subtraction by factoring out $-1$, and (2) we can always divide through numerator and denominator by the same number without changing the value of a fraction.

This gives us:
\begin{align}
\frac{1}{5(x-3)} &= \frac{1}{5} \cdot \frac{-1}{3-x} \\
&= \frac{1}{5} \cdot \frac{-1/3}{1-(x/3)} \\
&= \frac{-1}{15} \cdot \frac{1}{1-(x/3)}
\end{align}
and
\begin{align}
\frac{1}{5(x+2)} &= \frac{1}{5} \cdot \frac{1}{2-(-x)} \\
&= \frac{1}{5} \cdot \frac{1/2}{1-(-x/2)} \\
&= \frac{1}{10} \cdot \frac{1}{1-(-x/2)}
\end{align}

Putting this all together then,
\[f(x)=\frac{-1}{15} \cdot \frac{1}{1-(x/3)}-\frac{1}{10} \cdot \frac{1}{1-(-x/2)}.\]

We see that this generates the sequence $\left(\frac{-1}{15} \cdot\left(\frac{x}{3}\right)^{n}-\frac{1}{10} \cdot\left(\frac{-x}{2}\right)^{n}\right)_{n \geq 0}$.
\end{example}








\newpage

\section*{Quiz Questions}
\begin{enumerate}
  \item Which of the following is the sequence generated by the OGF $f(x)=4 e^{2 x}-\frac{1}{2-x}$ ?

  \textbf{Note}: Recall that $e^{x}=\sum_{n=0}^{\infty} \frac{x^{n}}{n!}$ and $\frac{1}{1-x}=\sum_{n=0}^{\infty} x^{n}$.
  \begin{align*}
    4 e^{2 x} &= 4 \sum_{n=0}^{\infty} \frac{(2 x)^{n}}{n!} = \sum_{n=0}^{\infty} 4 \cdot \frac{2^{n}}{n!} x^{n} \\
    -\frac{1}{2-x} &= -\frac{1}{2(1-(x/2))} = -\frac{1}{2} \sum_{n=0}^{\infty} \left(\frac{x}{2}\right)^{n} = \sum_{n=0}^{\infty} -\frac{1}{2^{n+1}} x^{n}
  \end{align*}

  Thus, the function $f(x)=4 e^{2 x}-\frac{1}{2-x}$ generates the sequence 
  $$\left(4 \cdot \frac{2^{n}}{n!}-\frac{1}{2^{n+1}}\right)_{n \geq 0}.$$


  
  \begin{enumerate}
    \item $\frac{4 \cdot 2^n}{n!}-\frac{1}{2^{n-1}}$
    \item $\frac{2^n}{n!}-\frac{1}{2^n}$
    \item $\frac{2^{n+1}}{n!}-\frac{1}{2^{n+2}}$
    \item $\frac{2^{n+2}}{n!}-\frac{1}{2^{n+1}}$
  \end{enumerate}

  \item True or False: If $f(x)$ is the OGF for 
  $\left(a_n\right)_{n \geq 0}$ and $g(x)$ 
  is the OGF for $\left(b_n\right)_{n \geq 0}$, then 
  $f(x) \cdot g(x)$ is the OGF for the sequence $\left(a_n b_n\right)_{n \geq 0}$.

  This is \textbf{False}. The product of two OGFs must be following distributive property.
  For example, 
  $$
  (1+x)(1+x^2) = 1 + x + x^2 + x^3
  $$
  However, the term-by-term product is
  $$
  (1,1,0,0,\ldots) \cdot (1,0,1,0,\ldots) = (1,0,0,0,\ldots)
  $$
  which is equivalent to 
  $$
  (1+x)(1+x^2) = 1 + x + x^2 + x^3 \neq 1 \text{ (Contradiction)}
  $$

  
  
  \newpage

  \item Suppose $\frac{2}{x^2-4}$ is the generating function for the 
  sequence $\left(a_n\right)_{n \geq 0}$, and $\frac{5 x}{7-x^4}$ is 
  the generating function for the sequence $\left(b_n\right)_{n \geq 0}$.\\
  Which of the following generates the convolution of the sequences 
  $\left(a_n\right)_{n \geq 0}$ and $\left(b_n\right)_{n \geq 0}$ ?

  \begin{align*}
    \frac{2}{x^2-4} \cdot \frac{5 x}{7-x^4} &= \frac{10 x}{(x^2-4)(7-x^4)} \\
    &= \frac{10 x}{-x^6+4 x^4+7 x^2-28}
  \end{align*}

  \begin{enumerate}
    \item $\frac{10 x}{-x^6+4 x^4+7 x^2-28}$
    \item $\frac{10}{-x^6+4 x^4+7 x^2-28}$
    \item $\frac{-2 x^4+5 x^3-20 x+14}{-x^6+4 x^4+7 x^2-28}$
    \item $\frac{5 x+2}{-x^6+4 x^4+7 x^2-28}$
  \end{enumerate}

  \item Find the partial fraction decomposition: $\frac{2}{(x-4)(6-x)}=\frac{A}{x-4}+\frac{B}{6-x}$, where
  $$
  A=\square
  $$
  $$
  B=\square
  $$

  $$\frac{2}{(x-4)(6-x)}=\frac{A(6-x)+B(x-4)}{(x-4)(6-x)}$$
  $$2=A(6-x)+B(x-4)$$
  Expanding the right-hand side gives:
  $$2=6A-Ax+Bx-4B$$
  Rearranging terms, we have:
  $$2=(6A-4B)+(B-A)x$$
  This gives us the system of equations:
  \begin{align*}
    6A-4B &= 2 \\
    B-A &= 0
  \end{align*}
  Solving this system, we find that $A=1$ and $B=1$.

\end{enumerate}





\newpage



\section*{Lesson M4.4: The Twelvefold Way, Part III: Integer Partitions}

\section*{Lesson}
We return at last to the two final entries yet to be solved in our 
Twelvefold Way table- let's remind ourselves of our current progress. 
The number of ways to place $k$ balls into $n$ baskets is:

\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
Balls & Baskets & Total solutions & At most 1 ball in each basket & At least 1 ball in each basket \\
\hline
Distinct & Distinct & A: $n^{k}$ & B: $P(n, k)$ & C: $S(k, n)=\sum_{i=0}^{n}(-1)^{i}\binom{n}{i}(n-i)^{k}$ \\
\hline
Identical & Distinct & D: $\binom{n+k-1}{k-1}$ & E: $\binom{n}{k}$ & F: $\binom{k-1}{n-1}$ \\
\hline
Distinct & Identical & G: $\left\{\begin{array}{c}k \\ 1\end{array}\right\}+\left\{\begin{array}{c}k \\ 2\end{array}\right\}+\cdots+\left\{\begin{array}{c}k \\ n\end{array}\right\}$ & H: 1 if $k \leq n$; 0 otherwise & I: $\left\{\begin{array}{c}k \\ n\end{array}\right\}=\frac{S(k, n)}{n!}$ \\
\hline
Identical & Identical & J: Unknown right now & K: 1 if $k \leq n$; 0 otherwise & L: Unknown right now; related to J \\
\hline
\end{tabular}
\end{center}

What remains to be discovered is the number of ways to place indistinct balls into indistinct baskets. With the tools we had last time we considered this question, we lacked the ability to do this really carefully and in a reasonably manageable way. It turns out, though, that generating functions are the trick we need to come up with a really nice solution.

Before we can solve this problem, though, we need to translate it. First, a definition:

\begin{definition}[Integer Partition]
For any positive integer $k$, a \textbf{partition of $k$} is a grouping of $k$ "ones" into positive, unordered summands (or parts). The number of partitions of $k$ is denoted $p(k)$.
\end{definition}

If we want to specify the number of positive summands involved in a partition, we use a subscript: $p_{n}(k)$ is the number of partitions of $k$ into exactly $n$ positive summands.

Example: We see below the number of partitions of the integers $0-4$, based on the actual partitions possible (which are listed):

$$
\begin{aligned}
& p(0)=1 \text { by convention } \\
& p(1)=1: 1 \\
& p(2)=2: 2,1+1 \\
& p(3)=3: 3,2+1,1+1+1 \\
& p(4)=5: 4,3+1,2+2,2+1+1,1+1+1+1
\end{aligned}
$$

Our first order of business is to note that this is an equivalent problem: we know the "ones" in any number are indistinct from each other, and the summands are unordered (remember this is equivalent to unlabeled, or indistinct). Thus if "ones" are "balls" and "summands" are "baskets," then the number of partitions of $k$ into exactly $n$ summands is precisely the number of ways to distribute $k$ identical balls into $n$ identical baskets so that no basket is empty- which is exactly the quantity we're looking for in box $L$ of our table.

Similarly, if we don't care how many of the baskets are actually used, we just need the number of partitions of $k$ into at most $n$ parts; we can find this by finding the number of partitions of $k$ into $i$\\
parts for $1 \leq i \leq n$, often written as $p_{\leq n}(k)=p_{1}(k)+p_{2}(k)+\cdots+p_{n}(k)$. This is the number of ways to place $k$ indistinct balls into $n$ indistinct baskets with no further conditions- or quantity J .

Thus our completed table is as follows:

\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
Balls & Baskets & Total solutions & At most 1 ball in each basket & At least 1 ball in each basket \\
\hline
Distinct & Distinct & A: $n^{k}$ & B: $P(n, k)$ & C: $S(k, n)=\sum_{i=0}^{n}(-1)^{i}\binom{n}{i}(n-i)^{k}$ \\
\hline
Identical & Distinct & D: $\binom{n+k-1}{k-1}$ & E: $\binom{n}{k}$ & F: $\binom{k-1}{n-1}$ \\
\hline
Distinct & Identical & G: $\left\{\begin{array}{c}k \\ 1\end{array}\right\}+\left\{\begin{array}{c}k \\ 2\end{array}\right\}+\cdots+\left\{\begin{array}{c}k \\ n\end{array}\right\}$ & H: 1 if $k \leq n$; 0 otherwise & I: $\left\{\begin{array}{c}k \\ n\end{array}\right\}=\frac{S(k, n)}{n!}$ \\
\hline
Identical & Identical & J: $p_{\leq n}(k)=p_{1}(k)+p_{2}(k)+\cdots+p_{n}(k)$ & K: 1 if $k \leq n$; 0 otherwise & L: $p_{n}(k)$ \\
\hline
\end{tabular}
\end{center}

We are not quite done yet though- we've translated a little bit and defined a concise notation for the quantities we wanted in boxes J and L , and have given a few very small examples, but in general we have no idea how to actually find $p_{n}(k)$ without just listing out every possible partition- which gets to be a daunting task very quickly!

We might try the same strategy we used to get quantity I from quantity C: can we somehow use stars and bars/binomial coefficients to count the number of ways to put identical objects into distinct groups, then divide to "unlabel" the baskets? This doesn't quite work-- this strategy worked before because we counted every possibility a constant number of times, but this is not the situation we currently have. For example, if we count ordered groupings of 15 , then $1+2+3+4+5$ is counted a very different number of times than $3+3+3+3+3$.

It turns out that there is not a particularly nice way of calculating $p(k)=p_{\leq k}(k), p_{n}(k)$, or any simply related quantity. A strategy that is successful, though, is to find a generating function for the sequence $(p(k))_{k \geq 0}$ - if we have this, then anytime we want $p(k)$, all we have to do is ask a computer for the coefficient of $x^{k}$ in our OGF. In the next lesson, we'll look at ways to manipulate this OGF to give us particular kinds of partitions.

We can construct this function the same way we've been doing: we can think of a particular partition of $k$ as a non-negative integer solution to the equation $(1) x_{1}+2 x_{2}+3 x_{3}+\cdots+k x_{k}=k$, where $x_{i}$ is the number of summands of size $i$ that appear in the given partition. Note the sum on the left side of the equation contains the terms it does since each summand of a partition of $k$ must be between (or equal to) 1 and $k$.

So now we use our generating functions to encode possible contributions of each term toward the total sum. One helpful thing to notice is that since our plan is to create an OGF that contains a particular coefficient, we actually don't need to worry about the possibility of making a function that gets "too big:" any possibilities that make the overall sum too big (such as $x_{1}=k+1$ ) can exist without hurting anything- they will just not actually contribute to the value of the coefficient of $x^{k}$.

We know now our summands of size 1 can contribute any number toward a sum of $k$ (i.e., $x_{1}$ can be any value), so this contribution is modeled by

$$
1+x+x^{2}+x^{3}+x^{4}+x^{5}+\cdots=\frac{1}{1-x}
$$

Similarly, $x_{2}$ can take on any non-negative value (we can theoretically include any number of 2 s in a partition of $k$ ), but their overall contribution has to be an even number so is modeled by

$$
1+x^{2}+x^{4}+x^{6}+x^{8}+\cdots=\frac{1}{1-x^{2}}
$$

We have to get a multiple of 3 from summands of size 3 (so $1+x^{3}+x^{6}+x^{9}+\cdots=\frac{1}{1-x^{3}}$ represents the contributions to the sum from summands of size 3 ), and so on.

So we see that, in general, the ways summands of size $i$ can contribute to the total can be represented by the OGF $f_{i}(x)=\frac{1}{1-x^{i}}$.

Now we have an OGF that models the possible contributions of each individual potential summand in our partition, and we need to combine all those possibilities into one OGF to allow for partitions using non-unique summands: again, it's okay if we include possibilities where the summands are larger than $k$, since the terms obtained from actually using those factors will all have larger powers of $x$ than the one we care about. Thus we can simply take an infinite product, and find that

\begin{theorem}[Partition Generating Function]
The number of partitions $p(k)$ of a non-negative integer $k$ is the coefficient of $x^{k}$ in the OGF
\[f(x)=\prod_{i=1}^{\infty} \frac{1}{1-x^{i}}\]
\end{theorem}

If we use what we know about $f_{i}(x)$ as defined above, we see that the number of partitions of $k$ into summands of size at most $n$ is given by the product of only the first $n$ terms of the function in our theorem, that is, $\prod_{i=1}^{n} \frac{1}{1-x^{i}}$ is the OGF for partitions of this type.

In particular, then, since we know partitions of $k$ may have summands of size at most $k$, we may safely truncate the given infinite product and find the coefficient of $x^{k}$ in $\prod_{i=1}^{k} \frac{1}{1-x^{i}}$.













\newpage


\section*{Lesson M4.5: Ferrers diagrams and Calculating $p_{n}(k)$}
\section*{Learning Goals}
\begin{itemize}
  \item Use generating functions to model the number of integer partitions satisfying a set of conditions
\end{itemize}

\section*{Textbook References}
Grimaldi: 9.3\\
Keller and Trotter: 8.5\\
Levin: Not Covered

\section*{Lesson}
We learned in the previous lesson that $f(x)=\prod_{i=1}^{\infty} \frac{1}{1-x^{i}}$ is the ordinary generating function for the sequence $(p(k))_{k \geq 0}$.

While it's great to be able to find the total number of partitions of $k$, it's also important to be able to count particular subsets of those partitions. In particular, since it's relevant to actually finding the values in our twelvefold way table, we want to know how to calculate $p_{n}(k)$ and $p_{\leq n}(k)$.

In order to better understand the manipulations we do to calculate these quantities, we define another way to visually represent partitions:

\begin{definition}[Ferrers Diagram]
The \textbf{Ferrers diagram} of a partition of $k$ displays each summand of size $i$ as a row of $i$ dots, arranged so that each row contains at least as many dots as the row below it. (This is equivalent to a convention of listing summands in order of size). Note the total number of dots in a diagram is always equal to $k$.
\end{definition}

Example: The partitions of 5, along with their associated Ferrers diagrams, are given below.\\

Ferrers diagrams help us to visualize partitions, but they also provide a key insight that allows us to actually find the quantities we want for our table.

Recall from the last lesson that the number of partitions of $k$ into summands of size at most $n$ is given by the coefficient of $x^{k}$ in the OGF $\prod_{i=1}^{n} \frac{1}{1-x^{i}}$.

While it is conventional to think of Ferrers diagrams as displaying each summand as a row (thus the number of rows is the number of parts in a particular partition), it really would be equally reasonable to assign this role to columns instead (each diagram would just correspond to a different partition).

If we visualize swapping rows and columns, we'll end up with the same set of diagrams- and really all we've done is swapped "number of parts" (\# of rows) with "size of the largest part" (\# of columns). That is, we have proved combinatorially that:

\begin{theorem}
The number of partitions of $k$ into at most $n$ parts is equal to the number of partitions of $k$ into parts of size $\leq n$.
\end{theorem}

Aha- this is a quantity we already know!\\
Result 1: So the total number of ways to place $k$ identical balls into $n$ identical baskets is $p_{\leq n}(k)$, which is the coefficient of $x^{k}$ in the OGF $\prod_{i=1}^{n} \frac{1}{1-x^{i}}$.

Example: Suppose we know that

$$
\prod_{i=1}^{5} \frac{1}{1-x^{i}}=1+x+2 x^{2}+3 x^{3}+5 x^{4}+7 x^{5}+10 x^{6}+13 x^{7}+18 x^{8}+23 x^{9}+30 x^{10}+\cdots
$$


Now all we need to do is figure out how many partitions of $k$ consist of exactly $n$ parts- it turns out Ferrers diagrams can help us here too. Suppose we want to draw a Ferrers diagram for a partition of $k$ that consists of exactly $n$ summands. By definition, the diagram needs to have exactly $n$ rows- so the first column needs to consist of $n$ dots.\\


Once we have placed those $n$ dots though, we can build the rest of the diagram however we'd like, using as many or as few of the established rows as desired. That is, we can get any Ferrers diagram for a partition of $k$ that has exactly $k$ parts by appending a column of $n$ dots to any Ferrers diagram representing a partition of $k-n$ into at most $n$ parts.

Because Ferrers diagrams correspond exactly to partitions (they just represent them visually), we conclude that the number of partitions of $k$ into exactly $n$ parts is equal to the number of partitions of $k-n$ into at most $n$ parts.

Result 2:Thus the number of ways to place $k$ identical balls into $n$ non-empty baskets is $p_{n}(k)$, the coefficient of $x^{k-n}$ in in the OGF $\prod_{i=1}^{n} \frac{1}{1-x^{i}}$.

Example: Again, recall that

$$
\prod_{i=1}^{5} \frac{1}{1-x^{i}}=1+x+2 x^{2}+3 x^{3}+5 x^{4}+7 x^{5}+10 x^{6}+13 x^{7}+18 x^{8}+23 x^{9}+30 x^{10}+\cdots
$$










\newpage


\section*{Lesson M4.6: Proof Via Generating Function}
\section*{Learning Goals}
\begin{itemize}
  \item Use generating functions together with combinatorial proofs to show equality
\end{itemize}

\section*{Textbook References}
Grimaldi: 9.3\\
Keller and Trotter: 8.5\\
Levin: Not Covered

\section*{Lesson}
\subsection*{Part 1: Detailed Manipulations}
So far, we have learned that $f(x)=\prod_{i=1}^{\infty} \frac{1}{1-x^{i}}$ is the ordinary generating function for the sequence $(p(k))_{k \geq 0}$ that gives the total number of partitions of each integer.

We saw in the last lesson that we can limit ourselves to count only partitions with summands of size at most $n$ by only using factors $\frac{1}{1-x^{i}}$ for values of $i$ that are between 1 and $n$ - but we can generalize this strategy to count partitions using any collection of summands.

\begin{theorem}
The product
\[\prod_{s \in S} \frac{1}{1-x^{s}}=\frac{1}{1-x^{s_{1}}} \frac{1}{1-x^{s_{2}}} \cdots \frac{1}{1-x^{s_{n}}} \cdots\]
is the OGF for the sequence whose $i^{\text{th}}$ term is the number of partitions of $i$ using only summands $s$ belonging to a set $S$.
\end{theorem}

Example: The OGF for the sequence consisting of the number of partitions of $n$ into parts of size 2, 3 , and/or 5 is $\frac{1}{1-x^{2}} \frac{1}{1-x^{3}} \frac{1}{1-x^{5}}$.

The OGF that gives the number of partitions of $n$ into only odd summands is $\frac{1}{1-x} \frac{1}{1-x^{3}} \frac{1}{1-x^{5}} \cdots=\prod_{i=1}^{\infty} \frac{1}{1-x^{2 i-1}}$.

\section*{Problem: Find the OGF for the number of partitions of $n$ into only even summands.}
We proceed similarly, but use only the even powers of $x$ to represent even summands: if $p_{e}(n)$ is the number of partitions of $n$ into even summands, the sequence $\left(p_{e}(n)\right)_{n \geq 0}$ is generated by $f(x)=\prod_{i=1}^{\infty} \frac{1}{1-x^{2 i}}$.

In addition to more nuanced manipulation of which summands could appear in the partitions we're counting, we might wish to limit the number of times any particular summand is used in a partition: we do this by changing the term $\frac{1}{1-x^{i}}$ corresponding to that summand $i$.

Recall that $\frac{1}{1-x^{i}}=1+x^{i}+x^{2 i}+x^{3 i}+\cdots$ represents the contributions of summands of size $i$ to the total sum (the number we're trying to partition) by using a term in the sum for each possible number of $i$ s in the partition. That is, 1 represents $0 i$ s, $x^{i}$ represents one $i, x^{k i}$ represents $k i$ s, and so on.

Example: Find the OGF giving the number $p_{d}(n)$ of partitions of $n$ into distinct parts.\\
In this set of partitions we can use any given summand at most once (otherwise if we used a summand twice, they would not be distinct). That means each potential summand $i$ (any positive integer, since that's not limited in this problem) can be used 0 or 1 times: to represent this we just use the polynomial $1+x^{i}$.

Thus the OGF we are looking for has one of these factors for each potential summand $i$ : it is $f(x)=\prod_{i=1}^{\infty}\left(1+x^{i}\right)$.

\section*{Problem: Find the OGF giving the number of partitions of $n$ where each summand is used at most twice.}
If each summand is used at most twice, it can be used 0,1 , or 2 times: thus each potential summand $i$ is represented in our OGF by a factor of $1+x^{i}+x^{2 i}$. Our OGF is then $f(x)=\prod_{i=1}^{\infty}\left(1+x^{i}+x^{2 i}\right)$.

It looks slightly more complex, but we can easily combine the ideas of limiting the repetition of each summand with limiting which summands are allowed. We just limit repetition using the term representing a particular summand, and limit which summands may be used by limiting which terms we include in our product.

Example: Find the OGF whose coefficients give the number of partitions of $n$ into odd summands, each of which appears an odd number of times or not at all.

We know each possible summand $i$ can appear $0,1,3,5,7 \ldots$ times, so is represented by $1+x^{i}+x^{3 i}+x^{5 i}+x^{7 i}+\cdots=1+\sum_{k=0}^{\infty}\left(x^{i}\right)^{2 k+1}$. Note since 0 doesn't fit the pattern of the rest of the numbers, we add that term separately.

Now we need to ensure that we only use odd parts: to be sure $i$ is odd, we can iterate through $i=2 m+1$ for $m \geq 0$.

Overall, then, our OGF is

$$
\prod_{m=1}^{\infty} 1+\sum_{k=0}^{\infty}\left(x^{2 m+1}\right)^{2 k+1}=\prod_{m=1}^{\infty} 1+\sum_{k=0}^{\infty} x^{(2 m+1)(2 k+1)}
$$

Proficiency in writing generating functions for different types of partitions, along with a couple of basic arithmetic facts, allows us to easily prove some interesting and advanced equalities that would otherwise be quite difficult.

\subsection*{Part 2: Proofs About Partitions}
Before we dive in, let's establish a few crucial properties.\\
\begin{lemma}[A]
$1+x+x^{2}+x^{3}+\cdots+x^{n}=\frac{1-x^{n+1}}{1-x}$, and more generally $1+x^{i}+x^{2 i}+\cdots x^{n i}=\frac{1-x^{(n+1) i}}{1-x^{i}}$.
\end{lemma}

These equalities can be derived from algebraic manipulations (the general case follows in the same way):

\begin{itemize}
  \item Method 1: Separate the right side of the equation into two fractions, and expand:
\end{itemize}

$$
\frac{1-x^{n+1}}{1-x}=\frac{1}{1-x}-\frac{x^{n+1}}{1-x}=\left(1+x+x^{2} \cdots\right)-\left(x^{n+1}+x^{n+2}+\cdots\right)=1+x+x^{2}+x^{3}+\cdots
$$

\begin{itemize}
  \item Method 2: Multiply both sides by $1-x$ :
\end{itemize}

$$
\left(1+x+\cdots x^{n}\right)-\left(x+x^{2}+\cdots x^{n+1}\right)=1-x^{n+1}
$$

The other two propositions we need won't be proved, but hopefully are somewhat intuitive.\\
\begin{lemma}[B]
If the sequences $\left(a_{n}\right)_{n \geq 0}$ and $\left(b_{n}\right)_{n \geq 0}$ are generated by the same function, then $a_{n}=b_{n}$ for all $n \geq 0$.
\end{lemma}

\begin{lemma}[C]
If two sequences of terms $a_{i}=b_{i}$ are equal for each $i \geq 0$, then the products $\prod_{i=1}^{\infty} a_{i}$ and $\prod_{i=1}^{\infty} b_{i}$ are also equal.
\end{lemma}

Putting all of these ideas together, we can create the following proof.

\begin{theorem}
For any positive integer $n$, the number of partitions of $n$ into odd parts is equal to the number of partitions into distinct parts.
\end{theorem}

\begin{proof}
First, recall that the number of partitions of $n$ into odd summands is given by

$$
f_{o}(x)=\prod_{i=1}^{\infty} \frac{1}{1-x^{2 i-1}},
$$

and the number of partitions of $n$ into distinct summands is given by

$$
f_{d}(x)=\prod_{i=1}^{\infty}\left(1+x^{i}\right)
$$

By proposition $B$, if we understand the number of partitions of $n$ into odd or distinct parts as the $n^{t h}$ term of the sequences generated by the functions $f_{o}(x)$ and $f_{d}(x)$, then to prove the number of partitions is equal all we need to do is show $f_{o}(x)=f_{d}(x)$.

Further, proposition C guarantees that since both functions consist of a product from $i=1$ to $\infty$, if we can prove each term of the two products is equal, we know the whole products (and thus the functions) are equal.

Finally, then, all we need to show is that $\frac{1}{1-x^{2 i-1}}=\left(1+x^{i}\right)$ - but this is just the result from substituting $n=1$ into the equality we proved in proposition A.
\end{proof}

As we wrap up this unit, let's reflect for a moment on what we were just able to do: we know in general it's quite difficult to even count any type of partition, but we were able to efficiently use generating functions to show that there are the same number of partitions following two very different and specific patterns!

In general proofs of this type are quite sophisticated- there are tons of identities like the one we just proved, and most of them are much more complex to show! First-class mathematicians have been working on research related to this type of identity for the last century- the most famous example are the "Rogers-Ramanujan Identities:"

\begin{itemize}
  \item The number of partitions of an integer $n$ where all parts differ by at least 2 is equal to the number of partitions of $n$ where all parts are congruent to 1 or $4(\bmod 5)$.
  \item The number of partitions of $n$ where parts differ by at least 2 and the smallest part is at least 2 equals the number of partitions of $n$ with all parts congruent to 2 or $3(\bmod 5)$.
\end{itemize}

These identities were discovered and proved by Leonard James Rogers and (independently) Srinivasa Ramanujan in the early 1900s (you may have heard of Ramanujan $\vec{G}$ (\href{https://en.wikipedia.org/wiki/Srinivasa_Ramanujan}{https://en.wikipedia.org/wiki/Srinivasa\_Ramanujan})\_- he was a phenomenal Indian mathematician who made huge contributions to several areas of math despite very little formal training and a tragically short life). Many identities of this type have been proven in the years since, and are still an active area of research today.









\newpage



\begin{abstract}
  This document provides formal definitions for several integer partition functions, introduces their associated ordinary generating functions, and presents a proof for a fundamental duality theorem that connects two distinct types of restricted partitions.
\end{abstract}

\section{Definitions of Partition Functions}

We begin by formally defining an integer partition and the functions that count them.

\begin{definition}[Integer Partition]
  An \textbf{integer partition} of a non-negative integer $k$ is a way of writing $k$ as a sum of positive integers, called \textbf{parts}. The order of the parts does not matter. For example, the partitions of $k=4$ are:
  \begin{itemize}
    \item $4$
    \item $3+1$
    \item $2+2$
    \item $2+1+1$
    \item $1+1+1+1$
  \end{itemize}
\end{definition}

\begin{definition}[The Partition Function $p(k)$]
  For $k\in\mathbb{Z}_{\ge0}$ define
  \[
    p(k)\;:=\;\Bigg|\Big\{(m_i)_{i\ge1}\in\mathbb{Z}_{\ge0}^{\mathbb{N}} :
    \sum_{i\ge1} i\,m_i = k,\; m_i=0\ \text{for all but finitely many }i\Big\}\Bigg|.
  \]
  Equivalently, $p(k)$ is the number of ways to write $k$ as an unordered sum of positive integers (order of summands ignored). By convention $p(0)=1$ (the empty partition).
\end{definition}

\begin{definition}[The Partition Function $p_n(k)$]
  The function $\boldsymbol{p_n(k)}$ denotes the number of partitions of $k$ into \textbf{exactly} $n$ parts. For example, $p_2(4)=2$ since the partitions of 4 into exactly two parts are $3+1$ and $2+2$.
\end{definition}

\begin{definition}[The Partition Function $p_{\le n}(k)$]
  The function $\boldsymbol{p_{\le n}(k)}$ denotes the number of partitions of $k$ into \textbf{at most} $n$ parts. This is equivalent to the sum $\sum_{j=1}^{n} p_j(k)$. For example, $p_{\le 2}(4) = p_1(4) + p_2(4) = 1 + 2 = 3$.
\end{definition}

\section{Generating Functions for Partitions}
A generating function is a formal power series whose coefficients encode a sequence of numbers. They are a powerful tool in combinatorics for solving counting problems.

\begin{theorem}[Generating Function for $p(k)$]
  The ordinary generating function for the sequence of partition numbers $p(k)$ is given by:
  $$ \sum_{k=0}^{\infty} p(k)x^k = \prod_{i=1}^{\infty} \frac{1}{1-x^i} $$
\end{theorem}

\begin{proof}[Sketch of Proof]
  We use the geometric series expansion $\frac{1}{1-y} = 1 + y + y^2 + \dots$.
  The product can be written as:
  $$ (1+x^1+x^{1+1}+\dots)(1+x^2+x^{2+2}+\dots)(1+x^3+x^{3+3}+\dots)\dots $$
  A term $x^k$ in the full expansion is formed by choosing one term from each factor, say $x^{m_1 \cdot 1}$ from the first, $x^{m_2 \cdot 2}$ from the second, and so on, such that their product is $x^k$. This corresponds to a sum:
  $$ k = m_1 \cdot 1 + m_2 \cdot 2 + m_3 \cdot 3 + \dots $$
  This is precisely a partition of $k$, where $m_1$ is the number of parts of size 1, $m_2$ is the number of parts of size 2, etc. The coefficient of $x^k$ is therefore the total number of ways to form such a sum, which is $p(k)$.
\end{proof}

\begin{theorem}[Generating Function for Partitions with Restricted Parts]
  Let $p_{\text{largest part } \le n}(k)$ be the number of partitions of $k$ where the largest part is at most $n$. Its generating function is:
  $$ \sum_{k=0}^{\infty} p_{\text{largest part } \le n}(k)x^k = \prod_{i=1}^{n} \frac{1}{1-x^i} $$
\end{theorem}
\begin{proof}
  The logic is identical to the proof above, but the product is truncated. Since the product only runs up to $i=n$, the available parts for any partition are restricted to the set $\{1, 2, \dots, n\}$.
\end{proof}


\section{The Duality Theorem (The ``Magic Trick'')}

We now arrive at the central theorem connecting the concepts from the previous sections. It establishes a surprising and powerful equivalence between two seemingly different types of restricted partitions.

\begin{theorem}\label{thm:duality}
  The number of partitions of $k$ into at most $n$ parts is equal to the number of partitions of $k$ where the largest part is at most $n$. That is:
  $$ p_{\le n}(k) = p_{\text{largest part } \le n}(k) $$
\end{theorem}

\begin{proof}
  We will establish a bijection (a one-to-one correspondence) between the set of partitions of $k$ into at most $n$ parts and the set of partitions of $k$ where the largest part is at most $n$. The visual tool for this proof is the \textbf{Ferrers diagram}.

  A Ferrers diagram represents a partition $\lambda = (\lambda_1, \lambda_2, \dots, \lambda_m)$ of $k$ as an array of dots, where the $i$-th row has $\lambda_i$ dots. For example, the partition of $k=10$ into $4+3+3$ is:
  \begin{center}
    \begin{tabular}{cccc}
      $\bullet$ & $\bullet$ & $\bullet$ & $\bullet$ \\
      $\bullet$ & $\bullet$ & $\bullet$ & \\
      $\bullet$ & $\bullet$ & $\bullet$ & \\
    \end{tabular}
  \end{center}
  
  The \textbf{conjugate} of a partition $\lambda$, denoted $\lambda'$, is the partition corresponding to the Ferrers diagram obtained by transposing the original diagram (swapping rows and columns). The number of parts in $\lambda'$ is equal to the size of the largest part in $\lambda$, and the size of the largest part in $\lambda'$ is equal to the number of parts in $\lambda$.

  For our example partition $4+3+3$:
  \begin{itemize}
    \item The number of parts is 3.
    \item The largest part is 4.
  \end{itemize}
  The conjugate diagram is:
  \begin{center}
    \begin{tabular}{ccc}
      $\bullet$ & $\bullet$ & $\bullet$ \\
      $\bullet$ & $\bullet$ & $\bullet$ \\
      $\bullet$ & $\bullet$ & $\bullet$ \\
      $\bullet$ & & \\
    \end{tabular}
  \end{center}
  This corresponds to the partition $3+3+3+1$. For this conjugate partition:
  \begin{itemize}
    \item The number of parts is 4.
    \item The largest part is 3.
  \end{itemize}
  
  Now, consider a partition of $k$ into \textbf{at most $n$ parts}. Its Ferrers diagram will have at most $n$ rows. When we take the conjugate, the number of columns in the new diagram will be at most $n$. The number of columns in a Ferrers diagram is equal to the size of its largest part. Therefore, the conjugate partition will have a \textbf{largest part of at most $n$}.

  This mapping (conjugation) is its own inverse. If you conjugate a partition twice, you get back the original partition. Thus, it is a bijection. Since we have a bijection between the set of partitions of $k$ with at most $n$ parts and the set of partitions of $k$ with a largest part of at most $n$, the sizes of these two sets must be equal. This concludes the proof.
\end{proof}

\begin{corollary}
  The generating function for $p_{\le n}(k)$ is $\prod_{i=1}^{n} \frac{1}{1-x^i}$.
\end{corollary}
\begin{proof}
  This follows directly from Theorem \ref{thm:duality} and Theorem 2.2. The generating function counts partitions where the largest part is at most $n$, and since this is equal to the number of partitions with at most $n$ parts, the same generating function applies to both.
\end{proof}



\end{document}